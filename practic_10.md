## Формула суммирования Пуассона

В [лекции 6](lecture_6) была получена формула суммирования Пуассона, которая нам сейчас понадобится для вычисления дискретной импульсной характеристики идеального дискретного НЧ-фильтра.

Один из полученных там вариантов этой формулы имеет вид
$$
\tau \sum_{k=-\infty}^{+\infty} g(t-k\tau) = \sum_{k=-\infty}^{+\infty} G(k/\tau)e^{i2 \pi k t/ \tau}
$$
где функция $\tilde G(\cdot)$ есть преобразование Фурье функции $g(\cdot)$. 

Левая часть этой формулы представляет собой некоторую $\tau$-периодическую функцию. Причем если функция $g(\cdot)$ финитная, и её носителем является интервал, длина которого меньше $\tau$, то эта функция, определяет выражение всей левой части (на одном периоде), т.к. в этом случае "наложений" при сдвигах функции $g(\cdot)$ не будет. Кроме того, значения $\tilde G(k/\tau)$ - есть ни что иное, как коэффициенты ряда Фурье в разложении левой части в этот ряд (по ортонормированной системе функций $e^{i2 \pi k t/ \tau}$).

Эта формула может быть использована для вычисления дискретной импульсной характеристики идеального дискретного фильтра (низкочастотного, высокочастотного, полосового, заградительного). С вычисления дискретной импульсной характеристики идеального фильтра того или иного вида начинается расчет коэффициентов соответствующего КИХ-фильтра (с использованием оконной функции того или иного вида).
## Импульсная характеристика идеального дискретного НЧ-фильтра

Частотная характеристика идеального низкочастотного дискретного фильтра имеет вид
$$
\stackrel{\frown}H_{\nu_0}(\nu)=\begin{cases}
1, & |\nu|< \nu_0 \\
0, & |\nu|> \nu_0
\end{cases}
$$
где $\nu_0$ - частота среза, причем безразмерная частота $\nu \in (-0.5; 0.5)$ ($0<\nu<0.5$). 

Дополнительно нам понадобится обозначение 
$$
Н_{\nu_0}(\nu)=\begin{cases}
\stackrel{\frown}H_{\nu_0}(\nu), & |\nu | < 0.5\\
0, & |\nu| > 0.5
\end{cases}

$$
т.е. можно считать, что функция $\stackrel{\frown}H(\nu)$ есть сужение функции $H(\nu)$ на интервал $(-0.5; \ 0.5)$.

Эта функция есть ДПФ импульсной характеристики $h[k]$ идеального дискретного фильтра ($k=0, \pm 1, \pm 2 ,...$),т.е. 
$$
\stackrel{\frown}H_{\nu_0}(\nu)=\sum_{k=-\infty}^{+\infty}h_{\nu_0}[k]e^{-i2\pi \nu k}
$$
В силу четности функции $\stackrel{\frown}H_{\nu_0}(\nu)$ в последней формуле знак в экспоненте можно заменить на противоположный, т.е.
$$
\stackrel{\frown}H_{\nu_0}(\nu)=\sum_{k=-\infty}^{+\infty}h_{\nu_0}[k]e^{i2\pi \nu k}
$$
Заметим теперь, эта формула совпадёт с записанной выше формулой суммирования Пуассона, если в последней сделать замену
$$
g(\cdot) \to H_{\nu_0}(\cdot), \ \  G(\cdot) \to h_{\nu_0}(\cdot), \ \   
\tau \to F_s, \ \  t \to f
$$
В результате получим
$$
F_s \sum_{k=-\infty}^{+\infty} H_{\nu_0}(f-kF_s) = \sum_{k=-\infty}^{+\infty} h_{\nu_0}(k/F_s)e^{i2 \pi k f/F_s}
$$
Если принять здесь $F_s=1$, то это будет означать, что частота $f$ измеряется в единицах величины $F_s$. Но величину $f/F_s$ мы обозначаем как $\nu$, поэтому имеем

$$
\sum_{k=-\infty}^{+\infty} H_{\nu_0}(\nu-k) = \sum_{k=-\infty}^{+\infty} h_{\nu_0}(k)e^{i2 \pi k \nu}
$$
При этом, если считать, что $\nu \in (-0.5; 0.5)$, то от суммы из левой части формулы Пуассона останется только одно слагаемое при $k=0$ (наложения соседних слагаемых в данном случае отсутствуют).

Поскольку преобразование Фурье функции $H_{\nu_0}(\nu)$ есть функция $\nu_0 \text{sinc}(\nu_0 t)$, то получаем искомое выражение дискретной импульсной характеристики 
$$
h_{\nu_0}[k]=2\nu_0 \text{sinc}(2\nu_0 k)
$$
где $k \in \mathbb Z$.

## Импульсная характеристика идеального полосового дискретного фильтра

Частотная характеристика идеального полосового дискретного фильтра имеет вид
$$
\stackrel{\frown}H_{\nu_L, \nu_H}(\nu)=\begin{cases}
1, & |\nu| \in (\nu_L; \nu_H) \\
0, & |\nu| \notin (\nu_L; \nu_H)
\end{cases}
$$
где $0 \le \nu_L < \nu_H \le 0.5$ - нижняя и верхняя частоты среза, соответственно, $\nu \in (-0.5; 0.5)$. 

Дополнительно будем использовать также обозначение 
$$
Н_{\nu_L, \nu_H}(\nu)=\begin{cases}
\stackrel{\frown}H_{\nu_L, \nu_H}(\nu), & \nu \in (-0.5; \ 0.5)\\
0, & \nu \notin (0.5;\ 0.5)
\end{cases}

$$
т.е. можно считать, что функция $\stackrel{\frown}H_{\nu_L, \nu_H}(\nu)$ есть сужение функции $H_{\nu_L, \nu_H}(\nu)$ на интервал $(-0.5; \ 0.5)$.

Можно заметить, что имеет место соотношение
$$
H_{\nu_L, \nu_H}(\nu)=H_{\nu_H}(\nu)-H_{\nu_L}(\nu)
$$
Поэтому, на основании предыдущего пункта (касающегося идеального НЧ-фильтра), получаем, что искомая импульсная характеристика идеального полосового фильтра есть
$$
h_{\nu_L, \nu_H}[k]=h_{\nu_H}[k]-h_{\nu_L}[k]
$$
т.е.

$$
h_{\nu_L, \nu_Y}[k]=\nu_H \text{sinc}(\nu_H k)-\nu_L \text{sinc}(\nu_L k)
$$

## Задание для практики

1. Задавшись некоторым значением частоты среза, например, $\nu_0=0.1$, исследовать влияние оконных функций на амплитудно-частотную характеристику низкочастотного КИХ-фильтра, построив соответствующие графики (в логарифмическом масштабе, т.е. с использованием шкалы децибел).
   
2. Построить графики фазочастотных характеристик спроектированных в предыдущем пункте КИХ-фильтров. Убедится в линейности этих фазочастотных характеристик, объяснить, в каком смысле, понимается эта линейность, и объяснить причину этой линейности.
   
3. Выполнить пункты 1 и 2 для разных значений частоты среза $\nu_0$ (например, для трех значений: 0.1, 0.01, 0.001), и исследовать влияние этого параметра на длину импульсной характеристики соответствующего КИХ-фильтра.
   
4. Выполнить пункты 1-3 для случая полосовых КИХ-фильтров 
   
5. Выполнить пункты 1-3 для случая КИХ-фильтров верхних частот.

